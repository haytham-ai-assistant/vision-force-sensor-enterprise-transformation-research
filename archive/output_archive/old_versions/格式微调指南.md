# 论文格式微调指南

## 快速调整脚本

已将常用格式调整命令封装为脚本 `format_adjust.sh`，您可以直接运行：

```bash
cd "/workspace/论文/视觉力学传感器企业战略转型研究-HSM"
bash scripts/format_adjust.sh [选项]
```

### 可用选项：
- `--double-spacing`：生成2倍行距版本
- `--single-spacing`：生成单倍行距版本  
- `--margin-2cm`：生成2cm页边距版本
- `--margin-3cm`：生成3cm页边距版本
- `--font-size-11`：生成11pt字体版本
- `--font-size-13`：生成13pt字体版本
- `--custom`：交互式自定义格式

## 手动调整方法

### 1. 行距调整

**当前设置**：1.5倍行距（格式化版）
**调整命令**：

```bash
# 单倍行距
pandoc cover_text.md complete_paper.md -o output/单倍行距版.docx --toc --toc-depth=3 -V line-spacing=1.0

# 2倍行距  
pandoc cover_text.md complete_paper.md -o output/双倍行距版.docx --toc --toc-depth=3 -V line-spacing=2.0

# 1.15倍行距（Word默认）
pandoc cover_text.md complete_paper.md -o output/标准行距版.docx --toc --toc-depth=3 -V line-spacing=1.15
```

### 2. 页边距调整

**当前设置**：2.5cm（PDF版本）
**调整命令**：

```bash
# 2cm页边距
pandoc cover_simple.md complete_paper.md -o output/窄边距版.pdf --pdf-engine=xelatex --toc --toc-depth=3 -V mainfont="Noto Serif CJK SC" -V geometry:a4paper,margin=2cm

# 3cm页边距
pandoc cover_simple.md complete_paper.md -o output/宽边距版.pdf --pdf-engine=xelatex --toc --toc-depth=3 -V mainfont="Noto Serif CJK SC" -V geometry:a4paper,margin=3cm

# 不对称页边距（左3cm，右2cm，上下2.5cm）
pandoc cover_simple.md complete_paper.md -o output/不对称边距版.pdf --pdf-engine=xelatex --toc --toc-depth=3 -V mainfont="Noto Serif CJK SC" -V geometry:a4paper,left=3cm,right=2cm,top=2.5cm,bottom=2.5cm
```

### 3. 字体调整

**当前设置**：12pt正文，Noto Serif CJK SC中文字体
**调整命令**：

```bash
# 11pt字体
pandoc cover_simple.md complete_paper.md -o output/小字体版.pdf --pdf-engine=xelatex --toc --toc-depth=3 -V mainfont="Noto Serif CJK SC" -V fontsize=11pt -V geometry:a4paper,margin=2.5cm

# 13pt字体
pandoc cover_simple.md complete_paper.md -o output/大字体版.pdf --pdf-engine=xelatex --toc --toc-depth=3 -V mainfont="Noto Serif CJK SC" -V fontsize=13pt -V geometry:a4paper,margin=2.5cm

# 更换中文字体（需要系统安装相应字体）
pandoc cover_simple.md complete_paper.md -o output/宋体版.pdf --pdf-engine=xelatex --toc --toc-depth=3 -V mainfont="SimSun" -V geometry:a4paper,margin=2.5cm

pandoc cover_simple.md complete_paper.md -o output/黑体版.pdf --pdf-engine=xelatex --toc --toc-depth=3 -V mainfont="SimHei" -V geometry:a4paper,margin=2.5cm
```

### 4. 纸张大小调整

```bash
# A4纸张（默认）
pandoc cover_simple.md complete_paper.md -o output/A4版.pdf --pdf-engine=xelatex --toc --toc-depth=3 -V mainfont="Noto Serif CJK SC" -V geometry:a4paper,margin=2.5cm

# Letter纸张
pandoc cover_simple.md complete_pmary.md -o output/Letter版.pdf --pdf-engine=xelatex --toc --toc-depth=3 -V mainfont="Noto Serif CJK SC" -V geometry:letterpaper,margin=1in

# A5纸张（小册子）
pandoc cover_simple.md complete_paper.md -o output/A5版.pdf --pdf-engine=xelatex --toc --toc-depth=3 -V mainfont="Noto Serif CJK SC" -V geometry:a5paper,margin=2cm
```

### 5. 页眉页脚调整

```bash
# 添加页眉
pandoc cover_simple.md complete_paper.md -o output/带页眉版.pdf --pdf-engine=xelatex --toc --toc-depth=3 -V mainfont="Noto Serif CJK SC" -V geometry:a4paper,margin=2.5cm -V header-includes='\usepackage{fancyhdr}\pagestyle{fancy}\fancyhf{}\fancyhead[C]{视觉力学传感器企业战略转型研究——以HSM为例}\fancyfoot[C]{\thepage}'

# 添加水印（需安装draftwatermark包）
pandoc cover_simple.md complete_paper.md -o output/水印版.pdf --pdf-engine=xelatex --toc --toc-depth=3 -V mainfont="Noto Serif CJK SC" -V geometry:a4paper,margin=2.5cm -V header-includes='\usepackage{draftwatermark}\SetWatermarkText{北大汇丰EMBA}\SetWatermarkScale{0.8}\SetWatermarkColor[gray]{0.9}'
```

### 6. 章节格式调整

```bash
# 调整目录深度（2级目录）
pandoc cover_text.md complete_paper.md -o output/二级目录版.docx --toc --toc-depth=2

# 无目录版本
pandoc cover_text.md complete_paper.md -o output/无目录版.docx --toc-depth=0

# 添加章节分页符
pandoc cover_text.md complete_paper.md -o output/分页版.docx --toc --toc-depth=3 -V classoption=openany
```

## 学校常见格式要求

### 北京大学汇丰商学院常见要求：

| 格式项 | 常见要求 | 对应调整命令 |
|--------|----------|--------------|
| **纸张** | A4 | `-V geometry:a4paper` |
| **页边距** | 上3cm、下2.5cm、左3cm、右2.5cm | `-V geometry:a4paper,top=3cm,bottom=2.5cm,left=3cm,right=2.5cm` |
| **行距** | 1.5倍或2倍 | `-V line-spacing=1.5` 或 `-V line-spacing=2.0` |
| **字体** | 宋体/黑体，12pt | `-V mainfont="SimSun" -V fontsize=12pt` |
| **页眉页脚** | 章节标题+页码 | 需使用fancyhdr包 |
| **装订** | 左侧装订，留出3cm装订线 | `-V geometry:a4paper,bindingoffset=3cm,left=4cm,right=2.5cm` |

### 快速生成学校格式：

```bash
# 北大汇丰常见格式
pandoc cover_text.md complete_paper.md -o output/学校格式版.docx --toc --toc-depth=3 \
  -V line-spacing=1.5 \
  -V mainfont="SimSun" \
  -V fontsize=12pt

pandoc cover_simple.md complete_paper.md -o output/学校格式版.pdf --pdf-engine=xelatex --toc --toc-depth=3 \
  -V mainfont="SimSun" \
  -V fontsize=12pt \
  -V geometry:a4paper,top=3cm,bottom=2.5cm,left=3cm,right=2.5cm
```

## 格式调整脚本

创建 `scripts/format_adjust.sh` 脚本：

```bash
#!/bin/bash

cd "/workspace/论文/视觉力学传感器企业战略转型研究-HSM"

case "$1" in
    --double-spacing)
        echo "生成2倍行距版本..."
        pandoc cover_text.md complete_paper.md -o output/双倍行距版.docx --toc --toc-depth=3 -V line-spacing=2.0
        echo "已生成: output/双倍行距版.docx"
        ;;
    --single-spacing)
        echo "生成单倍行距版本..."
        pandoc cover_text.md complete_paper.md -o output/单倍行距版.docx --toc --toc-depth=3 -V line-spacing=1.0
        echo "已生成: output/单倍行距版.docx"
        ;;
    --margin-2cm)
        echo "生成2cm页边距版本..."
        pandoc cover_simple.md complete_paper.md -o output/2cm边距版.pdf --pdf-engine=xelatex --toc --toc-depth=3 -V mainfont="Noto Serif CJK SC" -V geometry:a4paper,margin=2cm
        echo "已生成: output/2cm边距版.pdf"
        ;;
    --margin-3cm)
        echo "生成3cm页边距版本..."
        pandoc cover_simple.md complete_paper.md -o output/3cm边距版.pdf --pdf-engine=xelatex --toc --toc-depth=3 -V mainfont="Noto Serif CJK SC" -V geometry:a4paper,margin=3cm
        echo "已生成: output/3cm边距版.pdf"
        ;;
    --font-size-11)
        echo "生成11pt字体版本..."
        pandoc cover_simple.md complete_paper.md -o output/11pt字体版.pdf --pdf-engine=xelatex --toc --toc-depth=3 -V mainfont="Noto Serif CJK SC" -V fontsize=11pt -V geometry:a4paper,margin=2.5cm
        echo "已生成: output/11pt字体版.pdf"
        ;;
    --font-size-13)
        echo "生成13pt字体版本..."
        pandoc cover_simple.md complete_paper.md -o output/13pt字体版.pdf --pdf-engine=xelatex --toc --toc-depth=3 -V mainfont="Noto Serif CJK SC" -V fontsize=13pt -V geometry:a4paper,margin=2.5cm
        echo "已生成: output/13pt字体版.pdf"
        ;;
    --custom)
        echo "交互式格式调整"
        read -p "行距 (1.0, 1.5, 2.0): " line_spacing
        read -p "字体大小 (10, 11, 12, 13, 14): " font_size
        read -p "页边距 (cm): " margin
        read -p "输出文件名 (不含扩展名): " filename
        
        echo "生成自定义格式版本..."
        pandoc cover_text.md complete_paper.md -o "output/${filename}.docx" --toc --toc-depth=3 -V line-spacing=${line_spacing} -V fontsize=${font_size}pt
        
        pandoc cover_simple.md complete_paper.md -o "output/${filename}.pdf" --pdf-engine=xelatex --toc --toc-depth=3 -V mainfont="Noto Serif CJK SC" -V fontsize=${font_size}pt -V geometry:a4paper,margin=${margin}cm
        
        echo "已生成: output/${filename}.docx 和 output/${filename}.pdf"
        ;;
    *)
        echo "格式调整脚本"
        echo "用法: bash format_adjust.sh [选项]"
        echo ""
        echo "选项:"
        echo "  --double-spacing    生成2倍行距版本"
        echo "  --single-spacing    生成单倍行距版本"
        echo "  --margin-2cm        生成2cm页边距版本"
        echo "  --margin-3cm        生成3cm页边距版本"
        echo "  --font-size-11      生成11pt字体版本"
        echo "  --font-size-13      生成13pt字体版本"
        echo "  --custom            交互式自定义格式"
        echo ""
        echo "示例:"
        echo "  bash format_adjust.sh --double-spacing"
        echo "  bash format_adjust.sh --custom"
        ;;
esac
```

## 常见问题解决

### 问题1：PDF生成失败
**症状**：`pandoc: xelatex not found`
**解决**：
```bash
# 安装xelatex
apt-get update && apt-get install -y texlive-xetex texlive-fonts-recommended texlive-latex-recommended
```

### 问题2：中文字体不显示
**症状**：PDF中中文显示为方框
**解决**：
```bash
# 安装中文字体
apt-get install -y fonts-noto-cjk fonts-noto-cjk-extra
# 或更换字体为系统已有字体
```

### 问题3：行距调整无效
**症状**：Word中行距未改变
**解决**：
```bash
# 使用docx模板确保格式生效
pandoc cover_text.md complete_paper.md -o output/调整版.docx --toc --toc-depth=3 --reference-doc=template.docx
```

### 问题4：页边距设置错误
**症状**：实际页边距与设置不符
**解决**：
```bash
# 使用具体的上下左右边距设置
pandoc cover_simple.md complete_paper.md -o output/精确边距.pdf --pdf-engine=xelatex -V geometry:a4paper,top=3cm,bottom=2.5cm,left=3cm,right=2.5cm
```

## 高级格式调整

### 1. 使用自定义模板

```bash
# 创建模板文件
cat > template.docx << 'EOF'
# 在此处添加Word模板内容
# 或从现有文档导出模板
EOF

# 使用模板生成
pandoc cover_text.md complete_paper.md -o output/模板版.docx --toc --toc-depth=3 --reference-doc=template.docx
```

### 2. 添加封面页特殊格式

```bash
# 创建带特殊格式的封面
cat > custom_cover.md << 'EOF'
---
title: "视觉力学传感器企业战略转型研究——以HSM为例"
author: "老毕"
date: "2026年2月"
geometry: "top=3cm,bottom=2.5cm,left=3cm,right=2.5cm"
fontsize: 12pt
mainfont: "SimSun"
header-includes: |
  \usepackage{titling}
  \pretitle{\begin{center}\Huge\bfseries}
  \posttitle{\end{center}}
  \preauthor{\begin{center}\large}
  \postauthor{\end{center}}
  \predate{\begin{center}\large}
  \postdate{\end{center}}
---

# 视觉力学传感器企业战略转型研究——以HSM为例

## Research on Strategic Transformation of Vision Force Sensor Enterprises——Taking HSM as an Example

### 硕士学位论文

**作者：老毕**

**学院：北京大学汇丰商学院**

**专业：高级管理人员工商管理硕士（EMBA）**

**导师：（请填写导师姓名）**

**日期：2026年2月**

\newpage
EOF

# 合并生成
pandoc custom_cover.md complete_paper.md -o output/高级封面版.docx --toc --toc-depth=3
```

### 3. 批量生成多种格式

```bash
# 批量生成脚本
cat > batch_generate.sh << 'EOF'
#!/bin/bash

cd "/workspace/论文/视觉力学传感器企业战略转型研究-HSM"

# 生成不同行距版本
for spacing in 1.0 1.5 2.0; do
    pandoc cover_text.md complete_paper.md -o "output/行距${spacing}倍.docx" --toc --toc-depth=3 -V line-spacing=${spacing}
done

# 生成不同页边距版本
for margin in 2.0 2.5 3.0; do
    pandoc cover_simple.md complete_paper.md -o "output/边距${margin}cm.pdf" --pdf-engine=xelatex --toc --toc-depth=3 -V mainfont="Noto Serif CJK SC" -V geometry:a4paper,margin=${margin}cm
done

echo "批量生成完成！"
EOF

chmod +x batch_generate.sh
```

## 格式验证检查

生成后请检查：

```bash
# 检查文件基本信息
ls -lh output/*.docx output/*.pdf | grep -E "(双倍|单倍|2cm|3cm|11pt|13pt)"

# 检查文件完整性
file output/*.docx output/*.pdf
```

## 快速参考表

| 需求 | 命令示例 | 输出文件 |
|------|----------|----------|
| **行距调整** | `-V line-spacing=2.0` | `双倍行距版.docx` |
| **页边距调整** | `-V geometry:a4paper,margin=3cm` | `3cm边距版.pdf` |
| **字体调整** | `-V fontsize=11pt` | `11pt字体版.pdf` |
| **中文字体** | `-V mainfont="SimSun"` | `宋体版.pdf` |
| **目录深度** | `--toc-depth=2` | `二级目录版.docx` |
| **纸张大小** | `-V geometry:letterpaper` | `Letter版.pdf` |

---

**提示**：建议在最终提交前，使用学校的格式要求生成一个专门的版本，并请同学或导师帮忙检查格式是否符合要求。

*生成时间：2026年2月9日*  
*生成系统：海助（海塞姆科技有限公司人工智能助手）*